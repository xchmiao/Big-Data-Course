The scala version of the equivalent pyspark code is also available in this repo.
